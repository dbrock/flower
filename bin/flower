#!/bin/bash

case "$1" in
  -*) ;; *) command="$1"; shift ;;
esac

if [[ $command = power ]]; then
  command=pow
  cat <<'EOF'
                                            _._
                                          .'   '.
                                         /       \  ___
                        _..       _.--. |     /  |.'   `'.
               ;-._   .'   `\   .'     `\   \|   /        \
             .'    `\/       ; /     _   \.=..=./  _.'    /
             |       `\.---._| '.   .-'-.}`.<>.`{-'-.    /
          .--;   . ( .'      '.  \ .---.{ <>()<> }.--..-'
         / _  \_  './ _.       `-./     _},'<>`.{_    `\
        ( = \  )`""'\;--.         /  .-'/ )=..=;`\`-    \
        {= (|  )     /`.         /       /  /| \         )
        ( =_/  )__..-\         .'-..___.'    :  '.___..-'
         \    }/    / ;.____.-;/\      |      `   |
          '--' |  .'   |       \ \     /'.      _.'
    \,          \  '    /       |\.\   ;  /`--.-'
     |/         )    .'`-.    /  \ \  |`|        :/ ,
     |         /__.-'     \_.'jgs \ \ |-|         |/
————————————————————————————————————————————————————————————————————————————————
EOF
fi

if [[ $command ]]; then
  "flower-$command" "$@"
else
  echo -n $'\e[37m'
  cat <<'EOF'
                                            _._
                                          .'   '.
                                         /       \  ___
                        _..       _.--. |     /  |.'   `'.
               ;-._   .'   `\   .'     `\   \|   /        \
             .'    `\/       ; /     _   \.=..=./  _.'    /
             |       `\.---._| '.   .-'-.}`.<>.`{-'-.    /
          .--;   . ( .'      '.  \ .---.{ <>()<> }.--..-'
         / _  \_  './ _.       `-./     _},'<>`.{_    `\
        ( = \  )`""'\;--.         /  .-'/ )=..=;`\`-    \
        {= (|  )     /`.         /       /  /| \         )
        ( =_/  )__..-\         .'-..___.'    :  '.___..-'
         \    }/    / ;.____.-;/\      |      `   |
          '--' |  .'   |       \ \     /'.      _.'
    \,          \  '    /       |\.\   ;  /`--.-'
     |/         )    .'`-.    /  \ \  |`|        :/ ,
     |         /__.-'     \_.'jgs \ \ |-|         |/
EOF
  echo -n $'\e[0m'
  echo \
————————————————————————————————————————————————————————————————————————————————
  echo "\
         Exposing current directory as a basic Flower app..."
  echo \
————————————————————————————————————————————————————————————————————————————————
  [[ $PORT ]] || [[ -f .port ]] || flower pick-port
  flower ps1 node -e 'require("flower").listen()'
fi
