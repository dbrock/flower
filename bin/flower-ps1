#!/bin/bash

if [[ $# = 0 ]]; then
  echo : CUT-HERE |
  bash -i 3>&1 >/dev/null 2>&3 |
  perl -0777 -ne '
    s/[\s\S]*CUT-HERE\n([\s\S]*)exit\Z/$1/;
    print substr($_, 0, -1)
  '
else
  if [[ "$1 $2" = "sh -c" ]]; then
    command="$3"
  else
    command=$(printf '%q ' "$@")
  fi

  echo $(flower ps1)$'\e[90m'${command}$'\e[0m'
  "$@"
fi
